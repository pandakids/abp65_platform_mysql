(function(){$(function(){function f(){return i.DataTable({paging:!0,serverSide:!0,processing:!0,listAction:{ajaxFunction:r.getPaymentHistory},columnDefs:[{className:"control responsive",orderable:!1,render:function(){return""},targets:0},{targets:1,data:null,orderable:!1,defaultContent:"",rowAction:{element:$("<button/>").addClass("btn btn-xs btn-primary").text(app.localize("ShowInvoice")).click(function(){e($(this).data())})}},{targets:2,data:"creationTime",render:function(n){return moment(n).format("L")}},{targets:3,data:"editionDisplayName"},{targets:4,data:"gateway",render:function(n){return app.localize("SubscriptionPaymentGatewayType_"+n)}},{targets:5,data:"amount",render:$.fn.dataTable.render.number(",",".",2)},{targets:6,data:"status",render:function(n){return app.localize("SubscriptionPaymentStatus_"+n)}},{targets:7,data:"paymentPeriodType",render:function(n){return app.localize("PaymentPeriodType_"+n)}},{targets:8,data:"dayCount"},{targets:9,data:"paymentId"},{targets:10,data:"invoiceNo"},{targets:11,visible:!1,data:"id"}]})}function e(t){var r=t.invoiceNo,i=t.id;r?window.open("/AppAreaName/Invoice?paymentId="+i,"_blank"):u.createInvoice({subscriptionPaymentId:i}).done(function(){n.ajax.reload();window.open("/AppAreaName/Invoice?paymentId="+i,"_blank")})}var i=$("#PaymentHistoryTable"),r=abp.services.app.payment,u=abp.services.app.invoice,t=abp.services.app.subscription,n;$('a[data-toggle="tab"]').on("shown.bs.tab",function(t){var i=$(t.target).attr("href");if(i==="#SubscriptionManagementPaymentHistoryTab"){if(n)return;n=f()}});$("#btnDisableRecurringPayments").click(function(){abp.ui.setBusy();t.disableRecurringPayments({}).done(function(){abp.ui.clearBusy();$("#btnEnableRecurringPayments").closest("div.m-form__group").removeClass("d-none");$("#btnDisableRecurringPayments").closest("div.m-form__group").addClass("d-none");$("#btnExtend")&&$("#btnExtend").removeClass("d-none")})});$("#btnEnableRecurringPayments").click(function(){abp.ui.setBusy();t.enableRecurringPayments({}).done(function(){abp.ui.clearBusy();$("#btnDisableRecurringPayments").closest("div.m-form__group").removeClass("d-none");$("#btnEnableRecurringPayments").closest("div.m-form__group").addClass("d-none");$("#btnExtend").addClass("d-none")})})})})();